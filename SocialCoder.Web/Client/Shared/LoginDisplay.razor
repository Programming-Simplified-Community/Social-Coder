@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject IdentityAuthenticationStateProvider AuthStateProvider

<AuthorizeView>
    <Authorized>
        <MudButton>
            <MudIcon Color="Color.Inherit"
                     Icon="@Icons.Filled.ManageAccounts"/>
            &nbsp;@(context.User.Identity?.Name)
        </MudButton>
        <MudButton OnClick="BeginSignOut" Style="margin-right: 1.25rem;">
            <MudIcon Icon="@Icons.Filled.Logout"/>
            Logout
        </MudButton>
    </Authorized>
    <NotAuthorized>
        <MudButton OnClick="ToLogin">
            <MudIcon Icon="@Icons.Filled.Login" Color="Color.Inherit"/>
            &nbsp;Login
        </MudButton>
    </NotAuthorized>
</AuthorizeView>

@code{
    private async Task BeginSignOut(MouseEventArgs args)
    {
        await AuthStateProvider.Logout();
        Navigation.NavigateTo("/");
    }

    void ToLogin() => Navigation.NavigateTo("/login");
}
