@using MudBlazor.Utilities
@inherits LayoutComponentBase

<MudThemeProvider Theme="_theme" IsDarkMode="true"></MudThemeProvider>

<MudLayout>
    <MudAppBar Elevation="1" Dense="@_dense">
        <MudAvatar Color="Color.Warning" e Variant="Variant.Filled">
            <MudIcon Color="Color.Dark" Icon="@Icons.Custom.Uncategorized.Radioactive" Size="Size.Large"/>
        </MudAvatar>

        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.End" OnClick="@ToggleLeftDrawer"/>
        <h1 class="">Social Coder</h1>
        <MudSpacer></MudSpacer>
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@ToggleRightDrawer"/>
        <MudSpacer/>

        <MudProgressLinear Color="Color.Secondary" BufferValue="@BufferValue" Value="@Value" Style="width: 70px" Class="my-7"/>
        
        <MudDivider Vertical="true" FlexItem="true"/>

        <div Class="d-flex justify-space-around flex-wrap mt-4">


            <MudBadge Content="100" Color="Color.Primary" Overlap="true" Class="mx-6 my-4">
                <MudIcon Icon="@Icons.Material.Filled.Face" Color="Color.Default"/>
            </MudBadge>
            <MudBadge Content="3" Overlap="true" Class="mx-6 my-4">
                <MudIcon Icon="@Icons.Material.Filled.Message" Color="Color.Default"/>
            </MudBadge>
            <MudBadge Content="100" Color="Color.Primary" Overlap="true" Class="mx-6 my-4">
                <MudIcon Icon="@Icons.Material.Filled.Notifications" Color="Color.Default"/>
            </MudBadge>

        </div>
        <MudDivider Vertical="true" FlexItem="true"/>
        <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" Link="https://github.com/Programming-Simplified-Community/Social-Coder" Target="_blank"/>

    </MudAppBar>
    <MudDrawer @bind-Open="@_openLeft" Anchor="Anchor.Left" ClipMode="_clipMode" Breakpoint="@_breakpoint" PreserveOpenState="@_preserveOpenState" Elevation="1" Variant="@DrawerVariant.Mini">
        <MudNavMenu>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Store">Newsfeed</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.LibraryBooks">Overview</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Group">Groups</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Person">Members</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Badge" Href="Badges">Badges</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.QuestionMark">Quests</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Stream">Streams</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Event">Events</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Forum">Forums</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Settings">Marketplace</MudNavLink>

        </MudNavMenu>
    </MudDrawer >
    <MudDrawer @bind-Open="@_openRight" Anchor="Anchor.Right" ClipMode="_clipMode" Breakpoint="@_breakpoint" PreserveOpenState="@_preserveOpenState" Elevation="1" Variant="@DrawerVariant.Mini">
        <MudNavMenu>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Store">Newsfeed</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.LibraryBooks">Overview</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Group">Groups</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Person">Members</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Badge">Badges</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.QuestionMark">Quests</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Stream">Streams</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Event">Events</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Forum">Forums</MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Filled.Settings">Marketplace</MudNavLink>

        </MudNavMenu>
    </MudDrawer >
    <MudMainContent Class="pt-16 px-16">
        <MudContainer Class="mt-6">
            <MudExpansionPanels>
                <MudExpansionPanel Text="Temp options" MaxHeight="200">
                    <MudSelect Label="Select clip mode" @bind-Value="_clipMode">
                        <MudSelectItem Value="@DrawerClipMode.Never">Not clipped (DrawerClipMode.Never)</MudSelectItem>
                        <MudSelectItem Value="@DrawerClipMode.Docked">Drawer is docked (DrawerClipMode.Docked)</MudSelectItem>
                        <MudSelectItem Value="@DrawerClipMode.Always">Always (DrawerClipMode.Always)</MudSelectItem>
                    </MudSelect>
                    <MudSelect Label="Select breakpoint" @bind-Value="_breakpoint">
                        <MudSelectItem Value="@Breakpoint.Sm">Breakpoint.Sm</MudSelectItem>
                        <MudSelectItem Value="@Breakpoint.Md">Breakpoint.Md</MudSelectItem>
                        <MudSelectItem Value="@Breakpoint.Lg">Breakpoint.Lg</MudSelectItem>
                        <MudSelectItem Value="@Breakpoint.Xl">Breakpoint.Xl</MudSelectItem>
                    </MudSelect>
                    <MudSwitch @bind-Checked="@_preserveOpenState" Label="Preserve open state" Color="Color.Primary" Style="width:100%;"/>
                    <MudSwitch @bind-Checked="@_dense" Label="Dense appbar" Color="Color.Primary" Style="width:100%;"/>
                </MudExpansionPanel>
            </MudExpansionPanels>


        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    bool _drawerOpen;
    bool _dense;
    bool _preserveOpenState;
    Breakpoint _breakpoint = Breakpoint.Lg;
    DrawerClipMode _clipMode = DrawerClipMode.Never;

    public bool Rtl { get; set; }

    bool _openLeft = false;
    bool _openRight = false;

    void ToggleLeftDrawer()
    {
        _openLeft = !_openLeft;
    }

    void ToggleRightDrawer()
    {
        _openRight = !_openRight;
    }

    void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    /* Progress bar demo

    This will be used for the small xp bar on the appbar. 

    
    */
    private int Value { get; set; }
    public int BufferValue { get; set; }

    public async void SimulateProgress()
    {
        Value = 0;
        BufferValue = 50;
        do
        {
            if (_disposed)
            {
                return;
            }

            Value += 4;
            StateHasChanged();
            await Task.Delay(500);
            BufferValue += 5;
        } while (Value < 100);

        SimulateProgress();
    }

    protected override void OnInitialized() => SimulateProgress();

    bool _disposed;
    public void Dispose() => _disposed = true;

    /* Progress bar demo

    End progress bar  

    */


    readonly MudTheme _theme = new()
    {
        PaletteDark = new()
        {
            Primary = new MudColor("7750f8"),
            Secondary = new MudColor("40d04f"),
            Background = new MudColor("161b28"),
            AppbarBackground = new MudColor("7750f8"),
            TextPrimary = new MudColor("FFF"),
            TextSecondary = new MudColor("9aa4bf"),
            DrawerBackground = new MudColor("1d2333"),
            DrawerText = new MudColor("FFF"),
            Surface = new MudColor("1d2333")
        }
    };



}